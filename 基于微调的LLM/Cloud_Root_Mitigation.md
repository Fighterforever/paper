# Recommending Root-Cause and Mitigation Steps for Cloud Incidents Using Large Language Models

## 研究背景与问题

随着云计算系统的普及，云服务的生产事件（如宕机或性能下降）对客户体验和企业收入造成巨大影响。例如，亚马逊每小时宕机可能损失高达1亿美元。尽管AIOps（AI for IT Operations）技术在自动化事件生命周期的多个环节取得进展，但根本原因分析（Root-Cause Analysis, RCA）和缓解步骤推荐（Mitigation Steps Recommendation）仍主要依赖人工处理，耗时且容易出错。

现有挑战包括：

- **高复杂性**：事件的根本原因和缓解步骤通常涉及多轮沟通和深入技术分析。
- **数据多样性**：事件描述包含多种格式（如表格、代码片段、图片等），难以标准化处理。
- **领域知识依赖**：准确推断根本原因和缓解步骤需要丰富的领域经验。
- **自动化工具不足**：传统方法生成的建议过于通用，缺乏针对性。

为了解决这些问题，研究提出利用大型语言模型（LLMs）自动推荐根本原因和缓解步骤，旨在减少人工干预并提高效率。

---

## 研究目标与方法

### 核心目标
评估大型语言模型（特别是GPT-3.x系列）在以下任务中的表现：
1. **根本原因推荐**：输入事件标题和摘要，生成可能的根本原因。
2. **缓解步骤推荐**：基于事件信息，生成缓解步骤建议。

### 方法概述

#### 1. 数据准备
- **数据来源**：微软内部40,000+个真实生产事件，涵盖1,759个云服务。
- **数据清洗**：
  - 去除重复事件和无效内容（如瞬态事件、过短描述）。
  - 保留文本信息，剔除表格和图片。
- **数据划分**：按时间顺序分为训练集（35,820）、验证集（3,000）和测试集（2,000）。

#### 2. 模型选择
- **基线模型**：
  - RoBERTa（自然语言预训练）
  - CodeBERT（代码领域预训练）
- **实验模型**：
  - GPT-3系列：Curie（6.7B参数）、Codex（代码优化）、Davinci（175B参数）
  - GPT-3.5系列：Code-davinci-002（代码与文本混合训练）

#### 3. 训练策略
- **微调（Fine-tuning）**：使用LoRA方法降低参数更新量，仅调整少量权重。
- **零样本学习（Zero-Shot）**：直接测试模型在无微调时的表现。
- **多任务学习**：联合训练根本原因和缓解步骤任务，探索任务间知识迁移。

#### 4. 评估方法
- **自动指标**：
  - 词汇层面：BLEU-4、ROUGE-L、METEOR。
  - 语义层面：BERTScore、BLEURT、NUBIA。
- **人工评估**：
  - 邀请25位实际事件负责人（OCEs）对模型生成结果进行评分，评估**正确性**（是否相关）和**可读性**（是否清晰易懂）。

---

## 实验结果与分析

### 1. 根本原因推荐（RQ1）
- **自动指标**：RoBERTa和CodeBERT因生成通用回复（如“代码存在Bug”）在BLEU-4等指标上虚高。
- **实际效果**：GPT-3.5（Code-davinci-002）在人工评估中表现最佳，生成的相关性和准确性更高。
- **发现**：自动指标无法完全反映模型的实际表现，尤其是对于开放性任务（如根本原因推荐）。

### 2. 缓解步骤推荐（RQ2）
- **表现趋势**：与根本原因推荐类似，GPT-3.5模型在BLEU-4等指标上优于其他模型。
- **补充信息的影响**：若输入中提供真实根本原因，缓解步骤的准确性显著提升（BLEU-4提升26%）。

### 3. 微调 vs 零样本学习（RQ3）
- **零样本学习**：在未微调情况下，模型表现较差（BLEU-4仅0.8-2.8）。
- **微调效果**：微调后显著提升，尤其是在缓解步骤推荐任务中（BLEU-4从0.92提升至8.6）。

### 4. 多任务学习（RQ4）
- **结果**：多任务学习并未显著优于单任务学习，部分模型性能甚至下降（如BLEU-4平均下降2.8%）。

### 5. 输入信息的影响（RQ5）
- **根本原因的作用**：在输入中提供根本原因显著提高了缓解步骤的准确性（如Code-davinci-002的BLEU-4提升26%）。

### 6. 事件类型的影响（RQ6）
- **机器检测 vs 人工检测事件**：
  - 机器检测事件模式更固定，模型推荐效果优于人工检测事件（BLEU-4提升9.5%）。
  - 人工检测事件因独特性和多样性，推荐难度更高。

---

## 关键技术创新

1. **大语言模型的应用**：
   - 利用GPT-3.x的强大生成能力处理开放性任务。
   - 结合LoRA方法高效微调大规模模型。

2. **多源数据整合**：
   - 自动清洗和标准化事件描述，确保模型输入一致性。

3. **人工评估验证**：
   - 弥补自动指标的局限性，通过实际用户反馈评估模型实用性。

4. **任务间知识迁移**：
   - 探索根本原因和缓解步骤任务间的协同效应。

---

## 实际应用与部署

### 用户反馈
- **正确性**：Code-davinci-002模型的建议被认为更相关（平均得分3.52/5）。
- **可读性**：所有模型的可读性评分均高于正确性评分（平均4.52/5）。
- **整体评价**：超过70%的用户认为LLMs在事件管理中有潜力。

### 应用场景
- 辅助值班工程师快速定位问题。
- 自动生成事件总结和故障排除指南。
- 在大规模云环境中实现部分自动化。

---

## 总结与意义

本研究首次系统验证了大型语言模型在云事件管理中的有效性，为AIOps提供了新的技术路径。关键贡献包括：

1. **开创性探索**：证明GPT-3.x模型在根本原因和缓解步骤推荐中的潜力。
2. **大规模实验**：基于40,000+真实事件的严格评估。
3. **人机协同**：结合自动指标和人工评估，全面衡量模型性能。

尽管模型在某些复杂事件中表现有限，但其整体效果已展现出强大的应用前景。未来可通过增强数据质量和模型能力进一步提升性能，为云服务的可靠性和可用性提供更强保障。