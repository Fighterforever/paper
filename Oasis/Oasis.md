# Oasis方法的详细实现过程

## 1. 影响范围评估(Impact Scope Assessment)实现

Oasis通过三种不同的链接技术来聚合与中断相关的事件，形成完整的影响范围评估：

### 1.1 基于规则的链接(Rule-based Linking)
- **实现原理**：利用IcM系统的自动事件链接功能，关联和去重事件以减少告警风暴
- **具体实现**：
  - 工程师基于领域知识设置特定规则触发事件链接
  - 例如：设置规则将由相同KPI异常触发的事件自动链接在一起
  - 这些是结构化的事件链接，可直接从IcM数据库查询

### 1.2 基于历史查找的链接(Historical Lookup)
- **实现原理**：利用历史事件链接模式自动学习云系统组件间的相关性
- **具体实现分两个阶段**：
  - **离线阶段**：
    - 使用事件报告中的组件字段信息
    - 构建组件链接图：如事件A和事件B链接，则在组件图中链接它们的组件
    - 利用历史链接数据形成组件间依赖关系网络
  - **在线阶段**：
    - 检查链接组件上是否有活动事件(在短时间范围内)
    - 将新事件匹配到组件图中的现有模式

### 1.3 基于预测模型的链接(Deep Learning-based Linking)
- **实现原理**：使用深度学习自动发现事件间关系，适应云系统的快速变化
- **具体实现**：
  - 训练神经网络预测事件间的链接关系
  - **输入**：两个事件的标题和描述文本
  - **输出**：事件间标题的相似度
  - **判断标准**：如相似度大于阈值，则确定两事件相关联
  - **训练数据**：工程师实际链接的事件对标记为正样本，未链接的为负样本

## 2. 总结生成(Summary Generation)实现

Oasis根据聚合的相关事件信息，使用微调的大型语言模型自动生成中断总结：

### 2.1 领域特定文本处理
- **实现原理**：将结构化事件信息转换为GPT-3可处理的上下文文本
- **具体实现**：
  - 按严重性对相关事件进行排序(高严重性优先)
  - 将事件转换为结构化文本段落：
    ```
    第i个事件的标题是...
    第i个事件的描述是...
    第i个事件的服务是...
    ```
  - 在文本末尾添加指令提示："中断总结是："

### 2.2 GPT-3.x模型微调
- **实现原理**：使用领域数据微调预训练模型，使其学习云系统特定知识
- **具体实现**：
  - 选择两种GPT-3模型变体进行实验：
    - **Curie(GPT-3)**：6.7B参数，在自然语言语料库上预训练
    - **DaVinci(GPT-3.5)**：175B参数，在文本和代码上预训练
  - 使用云系统特定训练数据进行微调：
    - **输入**：相关事件的处理文本作为上下文
    - **输出**：工程师编写的中断总结作为期望补全
  - 微调使模型学习：
    - 云系统和事件的领域知识
    - 强调工程师关注的重要方面
    - 从噪声源中有效提取信息的能力

### 2.3 系统实现与集成
- **架构组成**：四个主要部分协同工作
  1. **Oasis后端**：
     - 定期查询活动事件和链接信息
     - 接收API调用后应用链接技术
     - 处理事件文本并调用微调的GPT-3.x模型
     - 返回生成的总结给IcM后端
  
  2. **本地数据库**：
     - 以流式方式从IcM数据库提取数据
     - 保持实时数据记录以支持链接功能
  
  3. **预测模型**：
     - 在ML专用服务器上预训练完成
     - 导出为二进制文件以优化生产环境性能
  
  4. **微调的GPT-3.x**：
     - 生成最终的中断总结文本

系统流程为：当IcM后端发起特定中断查询时，Oasis后端应用预测模型确定相关事件，执行文本处理，调用GPT-3.x生成总结，最终将结果返回IcM后端，整个过程高效自动化，生成速度比手动总结快251.2倍。